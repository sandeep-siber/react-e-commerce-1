"use strict";(self.webpackChunkreact_complete_guide=self.webpackChunkreact_complete_guide||[]).push([[961],{4123:function(e,r,n){n.d(r,{Z:function(){return o}});n(2791);var a="Card_card__AxeL7",t=n(184);var o=function(e){return(0,t.jsx)("div",{className:"".concat(a," ").concat(e.className),children:e.children})}},5961:function(e,r,n){n.r(r),n.d(r,{action:function(){return w},default:function(){return j}});var a=n(4165),t=n(5861),o=n(1989),s=n(6853),i=n(9439),l=n(1087),u=n(7689),c=n(2791),d={value:"",isTouched:!1};function m(e,r){return"INPUT"===r.type?{value:r.value,isTouched:e.isTouched}:"BLUR"===r.type?{isTouched:!0,value:e.value}:"RESET"===r.type?{isTouched:!1,value:""}:d}var h=function(e){var r=(0,c.useReducer)(m,d),n=(0,i.Z)(r,2),a=n[0],t=n[1],o=e(a.value),s=!o&&a.isTouched;return{value:a.value,hasError:s,valueChangeHandler:function(e){t({type:"INPUT",value:e.target.value})},inputBlurHandler:function(e){t({type:"BLUR"})},isValid:o,reset:function(){t({type:"RESET"})}}},p=n(4123),g=n(2939),v=n(184),f=function(e){return e.includes("@")},x=function(e){return e.trim().length>5};var _=function(){var e=h(f),r=e.value,n=e.isValid,a=e.hasError,t=e.valueChangeHandler,o=e.inputBlurHandler,s=h(x),c=s.value,d=s.isValid,m=s.hasError,_=s.valueChangeHandler,j=s.inputBlurHandler,w=h((function(e){return e===(d&&c)})),Z=w.value,b=w.isValid,C=w.hasError,y=w.valueChangeHandler,N=w.inputBlurHandler,S=(0,l.lr)(),T="login"===(0,i.Z)(S,1)[0].get("mode"),A=(0,u.nA)();A&&(console.log("data ",A),Object.values(A.error.errors).map((function(e){return console.log(e.message)})));var E="submitting"===(0,u.HJ)().state,k=!1;n&&d&&(T||b)&&(k=!0);var F=a?"".concat(g.Z["form-control"]," ").concat(g.Z.invalid):g.Z["form-control"],H=m?"".concat(g.Z["form-control"]," ").concat(g.Z.invalid):g.Z["form-control"],I=C?"".concat(g.Z["form-control"]," ").concat(g.Z.invalid):g.Z["form-control"];return(0,v.jsx)(p.Z,{className:g.Z.wrapper,children:(0,v.jsxs)(l.l0,{method:"post",className:g.Z.auth,children:[(0,v.jsx)("h1",{children:T?"Login":"Sign up"}),(0,v.jsx)("div",{className:g.Z.errors,children:A&&A.error&&(0,v.jsx)("ul",{children:Object.values(A.error.errors).map((function(e){return(0,v.jsx)("li",{children:e.message},e)}))})}),(0,v.jsxs)("div",{className:F,children:[(0,v.jsx)("label",{htmlFor:"email",children:"E-Mail"}),(0,v.jsx)("input",{name:"email",type:"email",id:"email",onChange:t,onBlur:o,value:r}),a&&(0,v.jsx)("p",{children:"Invalid email entered"})]}),(0,v.jsxs)("div",{className:H,children:[(0,v.jsx)("label",{htmlFor:"password",children:"Password"}),(0,v.jsx)("input",{name:"password",type:"password",id:"password",onChange:_,onBlur:j,value:c}),m&&(0,v.jsx)("p",{children:"Password must have min 6 chars"})]}),!T&&(0,v.jsxs)("div",{className:I,children:[(0,v.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),(0,v.jsx)("input",{type:"password",id:"confirmPassword",onChange:y,onBlur:N,value:Z}),C&&(0,v.jsx)("p",{children:"Confirm password does not match "})]}),(0,v.jsxs)("div",{className:g.Z.actions,children:[(0,v.jsx)("button",{disabled:!k||E,children:E?"Submitting...":T?"Login":"Create Account"}),(0,v.jsx)(l.rU,{to:"?mode=".concat(T?"signup":"login"),className:g.Z.toggle,children:T?"Create new user":"Login"})]})]})})};var j=function(){return(0,v.jsx)(_,{})};function w(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,t.Z)((0,a.Z)().mark((function e(r){var n,t,i,l,u,c,d,m,h,p,g,v;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.request,t=new URL(n.url).searchParams,i=t.get("mode")||"login",l="login"===i?s.ZE:"signup"===i?s.iG:"Wrong Mode","login"===i||"signup"===i){e.next=6;break}throw(0,o.AV)({message:"Unsupported mode"},{status:422});case 6:return e.next=8,n.formData();case 8:return u=e.sent,c={email:u.get("email"),password:u.get("password"),returnSecureToken:!0},e.next=12,fetch(l,{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}});case 12:if(400!==(d=e.sent).status){e.next=15;break}return e.abrupt("return",d);case 15:if(d.ok){e.next=17;break}throw(0,o.AV)({message:"Could not authenticate user"},{status:500});case 17:return e.next=19,d.json();case 19:return m=e.sent,h=m.idToken,p=m.localId,g=m.email,localStorage.setItem("token",h),localStorage.setItem("userId",p),localStorage.setItem("userEmail",g),(v=new Date).setHours(v.getHours()+1),localStorage.setItem("expiration",v.toISOString()),e.abrupt("return",(0,o.uX)("/"));case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},2939:function(e,r){r.Z={wrapper:"AuthForm_wrapper__+gqAD",auth:"AuthForm_auth__i9NeK",errors:"AuthForm_errors__8i5MD","form-control":"AuthForm_form-control__bSr9b",invalid:"AuthForm_invalid__gE4mt",actions:"AuthForm_actions__zfFG6",toggle:"AuthForm_toggle__zEayz"}}}]);
//# sourceMappingURL=961.6315580c.chunk.js.map